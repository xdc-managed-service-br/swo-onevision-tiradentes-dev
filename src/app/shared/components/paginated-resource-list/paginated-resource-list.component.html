<div class="resource-list-container">
    <div class="resource-list-header">
      <h2>{{ title }}</h2>
      
      <div class="filter-bar" *ngIf="columns && columns.length > 0">
        <div class="filter-group" *ngFor="let column of columns | slice:0:3">
          <label [for]="'filter-' + column.key">{{ column.label }}</label>
          <input 
            type="text" 
            [id]="'filter-' + column.key" 
            [placeholder]="'Filter by ' + column.label.toLowerCase()" 
            (input)="applyFilter(column.key, $event.target.value)"
          >
        </div>
        
        <button 
          class="reset-button" 
          (click)="resetFilters()" 
          [disabled]="loading || !currentFilters || Object.keys(currentFilters).length === 0"
        >
          Reset Filters
        </button>
      </div>
    </div>
    
    <app-loading-spinner *ngIf="loading" message="Loading resources..."></app-loading-spinner>
    
    <div *ngIf="!loading && (!queryResult || queryResult.items.length === 0)" class="no-data">
      No resources found matching the current filters.
    </div>
    
    <table *ngIf="!loading && queryResult && queryResult.items.length > 0" class="resource-table">
      <thead>
        <tr>
          <ng-container *ngFor="let column of columns">
            <th 
              (click)="sortBy(column.key)" 
              [class.sortable]="true"
            >
              {{ column.label }}
              <span *ngIf="sortField === column.key" class="sort-indicator">
                {{ sortDirection === 'asc' ? '▲' : '▼' }}
              </span>
            </th>
          </ng-container>
          <th *ngIf="actions && actions.length > 0">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr 
          *ngFor="let resource of queryResult.items" 
          (click)="handleRowClick(resource)"
          class="resource-row"
        >
          <ng-container *ngFor="let column of columns">
            <td [attr.data-label]="column.label">
              {{ formatValue(resource, column) }}
            </td>
          </ng-container>
          <td *ngIf="actions && actions.length > 0" class="actions-cell">
            <button 
              *ngFor="let action of actions" 
              class="action-button"
              (click)="$event.stopPropagation(); handleAction(action.action, resource)"
            >
              <i *ngIf="action.icon" [class]="action.icon"></i>
              {{ action.label }}
            </button>
          </td>
        </tr>
      </tbody>
    </table>
    
    <div class="resource-list-footer">
      <div class="pagination-info" *ngIf="queryResult && queryResult.items.length > 0">
        Showing {{ queryResult.items.length }} resources
      </div>
      
      <div class="pagination-controls">
        <button 
          class="load-more-button" 
          *ngIf="queryResult && queryResult.nextToken" 
          [disabled]="loading"
          (click)="loadNextPage()"
        >
          Load More
        </button>
      </div>
    </div>
    
    <app-export-toolbar 
      *ngIf="showExport && queryResult && queryResult.items.length > 0"
      [resourceType]="resourceType"
      [resourceCount]="queryResult ? queryResult.items.length : 0"
      [region]="queryOptions.region"
      [accountId]="queryOptions.accountId"
    ></app-export-toolbar>
  </div>