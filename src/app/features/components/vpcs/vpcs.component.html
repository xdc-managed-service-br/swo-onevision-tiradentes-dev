<!-- src/app/features/components/vpcs/vpcs.component.html -->
<div class="vpcs-container">
  <div class="page-header">
    <h1>VPCs</h1>
    <p class="page-description">Manage your AWS Virtual Private Cloud configurations</p>
  </div>

  <!-- Filters Section -->
  <div class="filters-section">
    <div class="search-box">
      <input
        type="text"
        [(ngModel)]="searchTerm"
        (input)="onSearchChange()"
        placeholder="Search by VPC ID, CIDR block, or tags..."
        class="search-input">
      <svg class="search-icon" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
      </svg>
    </div>

    <div class="filter-controls">
      <select [(ngModel)]="selectedAccount" (change)="onFilterChange()" class="filter-select">
        <option value="">All Accounts</option>
        <option *ngFor="let account of uniqueAccounts" [value]="account">{{ account }}</option>
      </select>

      <select [(ngModel)]="selectedRegion" (change)="onFilterChange()" class="filter-select">
        <option value="">All Regions</option>
        <option *ngFor="let region of uniqueRegions" [value]="region">{{ region }}</option>
      </select>

      <select [(ngModel)]="selectedState" (change)="onFilterChange()" class="filter-select">
        <option value="">All States</option>
        <option *ngFor="let state of uniqueStates" [value]="state">{{ state }}</option>
      </select>

      <button (click)="clearFilters()" class="clear-filters-btn">
        Clear Filters
      </button>
    </div>
  </div>

  <!-- Results Count -->
  <div class="results-summary">
    <span class="results-count">{{ filteredVpcs.length }} of {{ vpcs.length }} VPCs</span>
    <button (click)="loadVpcs()" class="refresh-btn" [disabled]="loading">
      <svg class="refresh-icon" [class.spinning]="loading" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />
      </svg>
      Refresh
    </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Loading VPCs...</p>
  </div>

  <!-- VPCs Table -->
  <div *ngIf="!loading" class="table-container">
    <div class="table-wrapper">
      <table class="vpcs-table">
        <thead>
          <tr>
            <th>VPC</th>
            <th>CIDR</th>
            <th>State</th>
            <th>Default</th>
            <th>DNS Settings</th>
            <th>Tenancy</th>
            <th>Account</th>
            <th>Region</th>
            <th>Last Updated</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let vpc of filteredVpcs; trackBy: trackByVpcId"
              class="table-row row-card"
              [ngClass]="getStateClass(vpc.state || '')">

            <!-- CARD LEFT: Name + ID + quick meta chips -->
            <td class="vpc-name">
              <div class="vpc-info">
                <div class="vpc-title-line">
                  <span class="name">{{ getVpcName(vpc) }}</span>
                  <span class="status-dot" [ngClass]="getStateClass(vpc.state || '')"></span>
                </div>
                <div class="vpc-subline">
                  <span class="id-badge">{{ vpc.vpcId }}</span>
                  <span class="chip mini" title="Default VPC?" [ngClass]="vpc.isDefault ? 'chip-ok' : 'chip-neutral'">{{ vpc.isDefault ? 'default' : 'custom' }}</span>
                </div>
              </div>
            </td>

            <!-- Core columns (kept for sorting/scanability) -->
            <td class="cidr-block">
              <code class="cidr">{{ vpc.cidrBlock || 'N/A' }}</code>
            </td>

            <td class="state">
              <span class="state-badge" [ngClass]="getStateClass(vpc.state || '')">
                {{ vpc.state || 'Unknown' }}
              </span>
            </td>

            <td class="default">
              <span class="default-badge" [ngClass]="vpc.isDefault ? 'is-default' : 'not-default'">
                {{ vpc.isDefault ? 'Yes' : 'No' }}
              </span>
            </td>

            <td class="dns-settings">
              <div class="dns-info">
                <span class="dns-item" [ngClass]="vpc.enableDnsSupport ? 'enabled' : 'disabled'">
                  <svg class="dns-icon" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                  </svg>
                  Support: {{ vpc.enableDnsSupport ? 'On' : 'Off' }}
                </span>
                <span class="dns-item" [ngClass]="vpc.enableDnsHostnames ? 'enabled' : 'disabled'">
                  <svg class="dns-icon" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                  </svg>
                  Hostnames: {{ vpc.enableDnsHostnames ? 'On' : 'Off' }}
                </span>
              </div>
            </td>

            <td class="tenancy">
              <span class="tenancy-badge">{{ vpc.tenancy || 'default' }}</span>
            </td>

            <td class="account">
              <span class="account-name">{{ vpc.accountName || vpc.accountId }}</span>
            </td>

            <td class="region">
              <span class="region-badge">{{ vpc.region }}</span>
            </td>

            <td class="last-updated">
              <span class="date">{{ vpc.lastUpdated | date:'short' }}</span>
            </td>
          </tr>

          <!-- Empty State -->
          <tr *ngIf="filteredVpcs.length === 0" class="empty-row">
            <td colspan="9" class="empty-state">
              <div class="empty-content">
                <svg class="empty-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <circle cx="12" cy="12" r="10"></circle>
                  <path d="m9 12 2 2 4-4"></path>
                </svg>
                <h3>No VPCs found</h3>
                <p>Try adjusting your search criteria or refresh the data.</p>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>